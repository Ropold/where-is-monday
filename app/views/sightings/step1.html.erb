<div class="container">
  <!-- Title and Add Sighting Button -->
  <div class="d-flex justify-content-center align-items-center my-4">
    <h4>Where did the sighting occur?</h4>
  </div>

  <!-- Search Form -->
  <div class="d-flex justify-content-center">
    <%= form_with url: sightings_step1_path, method: :get, local: true, class: "search-form mt-4 d-flex align-items-center" do %>
      <%= text_field_tag :query, params[:query], placeholder: "Enter city", class: "form-control form-control-lg w-auto rounded-pill" %>
      <%= submit_tag "Search", class: "btn btn-info btn-lg ms-2 rounded-pill" %>
    <% end %>
  </div>

  <!-- Grid Layout for Cards -->
  <% if !@cats.empty? %>

  <div class="d-flex align-items-center">
    <h4 class="my-2">Lost cats in <%= params[:query] %></h4>
    <div class="d-flex align-items-center">
      <p>If you didn't find the cat in this list, add a sighting here</p>
      <%= link_to "Add Sighting", add_sighting_path, class: "btn btn-info" %>
    </div>
  </div>




    <div class="grid">
      <% @cats.each do |cat| %>
        <div class="card box mb-4">
          <!-- Cat Info inside each card -->
            <% if cat.photo.attached? %>
              <div class="img-container" style="background-image: url('<%= cl_image_path cat.photo.key %>');"></div>
            <% end %>

            <div class="card-body">
              <h4 class="card-title py-2"><strong><%= cat.name %></strong></h4>
              <p><strong><%= "#{cat.name} was lost at: " %></strong></p>
              <p><%= cat.origin_address %></p>
              <% if cat.sightings.any? %>
              <p><strong><%= "Last seen at:" %></strong></p>
              <% last_sighting = cat.sightings.accepted.order(last_seen_at: :desc).first %>
              <p><%= last_sighting.address if last_sighting %></p>
              <p><%= last_sighting.last_seen_at.strftime("%A, %d %B %Y at: %H:%M") if last_sighting %></p>
              <%= link_to "Add sighting to this cat", cat_path(cat), class: "btn btn-info" %>
              <% else %>
                <p><strong>No sightings available yet.</strong></p>
              <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <strong><h1 class="text-center my-4"><%= "We have no lost cats in: #{params[:query]}" %></h1></strong>
  <% end %>
</div>
